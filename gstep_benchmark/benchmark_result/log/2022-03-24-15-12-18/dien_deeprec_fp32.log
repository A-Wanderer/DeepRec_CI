INFO:tensorflow:vocabulary_size = 543060 in UID is inferred from the number of elements in the vocabulary_file ./data/uid_voc.txt.
INFO:tensorflow:vocabulary_size = 367983 in ITEM is inferred from the number of elements in the vocabulary_file ./data/mid_voc.txt.
INFO:tensorflow:vocabulary_size = 1601 in CATEGORY is inferred from the number of elements in the vocabulary_file ./data/cat_voc.txt.
INFO:tensorflow:vocabulary_size = 367983 in HISTORY_ITEM is inferred from the number of elements in the vocabulary_file ./data/mid_voc.txt.
INFO:tensorflow:vocabulary_size = 1601 in HISTORY_CATEGORY is inferred from the number of elements in the vocabulary_file ./data/cat_voc.txt.
INFO:tensorflow:vocabulary_size = 367983 in NOCLK_HISTORY_ITEM is inferred from the number of elements in the vocabulary_file ./data/mid_voc.txt.
INFO:tensorflow:vocabulary_size = 1601 in NOCLK_HISTORY_CATEGORY is inferred from the number of elements in the vocabulary_file ./data/cat_voc.txt.
INFO:tensorflow:Parsing ./data/local_train_splitByUser
INFO:tensorflow:Parsing ./data/local_test_splitByUser
2022-03-24 07:22:05.390764: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3299995000 Hz
2022-03-24 07:22:05.397330: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f468eabf9c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2022-03-24 07:22:05.397369: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2022-03-24 07:22:09.662027: I tensorflow/core/profiler/lib/profiler_session.cc:205] Profiler session started.
2022-03-24 07:23:44.508751: I tensorflow/core/profiler/lib/profiler_session.cc:205] Profiler session started.
2022-03-24 07:24:49.911926: I tensorflow/core/profiler/lib/profiler_session.cc:205] Profiler session started.
Using TensorFlow version 1.15.5
Checking dataset
Numbers of training dataset is 1086120
Numbers of test dataset is 121216
Saving model checkpoints to /benchmark_result/checkpoint/2022-03-24-15-12-18/dien_deeprec_fp32
Save timeline to /benchmark_result/checkpoint/2022-03-24-15-12-18/dien_deeprec_fp32
global_step/sec: 14.7724
loss = 0.9788111448287964, steps = 0, cost time = 6.77s
global_step/sec: 15.5255
loss = 0.9731624126434326, steps = 100, cost time = 6.44s
global_step/sec: 2.9628
loss = 0.980384111404419, steps = 200, cost time = 33.75s
global_step/sec: 15.7510
loss = 0.9601396918296814, steps = 300, cost time = 6.35s
global_step/sec: 15.7707
loss = 0.9193384647369385, steps = 400, cost time = 6.34s
global_step/sec: 15.7666
loss = 0.9536462426185608, steps = 500, cost time = 6.34s
global_step/sec: 15.8048
loss = 0.9400433301925659, steps = 600, cost time = 6.33s
global_step/sec: 15.7478
loss = 0.905323326587677, steps = 700, cost time = 6.35s
global_step/sec: 15.7466
loss = 0.8990098237991333, steps = 800, cost time = 6.35s
global_step/sec: 15.7220
loss = 0.9366332292556763, steps = 900, cost time = 6.36s
Save timeline to /benchmark_result/checkpoint/2022-03-24-15-12-18/dien_deeprec_fp32
global_step/sec: 12.2989
loss = 0.9424233436584473, steps = 1000, cost time = 8.13s
global_step/sec: 15.7715
loss = 0.9419580698013306, steps = 1100, cost time = 6.34s
global_step/sec: 15.7537
loss = 0.9075092077255249, steps = 1200, cost time = 6.35s
global_step/sec: 15.7012
loss = 0.921139121055603, steps = 1300, cost time = 6.37s
global_step/sec: 15.7087
loss = 0.9596270322799683, steps = 1400, cost time = 6.37s
global_step/sec: 15.7065
loss = 0.9468059539794922, steps = 1500, cost time = 6.37s
global_step/sec: 15.7312
loss = 0.8807114362716675, steps = 1600, cost time = 6.36s
global_step/sec: 15.7190
loss = 0.9643459320068359, steps = 1700, cost time = 6.36s
global_step/sec: 15.7089
loss = 0.9005974531173706, steps = 1800, cost time = 6.37s
global_step/sec: 15.6921
loss = 0.8828259706497192, steps = 1900, cost time = 6.37s
Save timeline to /benchmark_result/checkpoint/2022-03-24-15-12-18/dien_deeprec_fp32
global_step/sec: 12.4303
loss = 0.9806712865829468, steps = 2000, cost time = 8.04s
global_step/sec: 15.7071
loss = 0.9554145336151123, steps = 2100, cost time = 6.37s
global_step/sec: 15.6793
loss = 0.8610838651657104, steps = 2200, cost time = 6.38s
global_step/sec: 15.6826
loss = 0.8856635093688965, steps = 2300, cost time = 6.38s
global_step/sec: 15.7366
loss = 0.8360859751701355, steps = 2400, cost time = 6.35s
global_step/sec: 15.7093
loss = 0.9516433477401733, steps = 2500, cost time = 6.37s
global_step/sec: 15.6765
loss = 0.8379989862442017, steps = 2600, cost time = 6.38s
global_step/sec: 15.6605
loss = 0.9653348922729492, steps = 2700, cost time = 6.39s
global_step/sec: 15.6776
loss = 0.895155668258667, steps = 2800, cost time = 6.38s
global_step/sec: 15.6970
loss = 0.8415362238883972, steps = 2900, cost time = 6.37s
global_step/sec: 475.1381
loss = 0.9110000729560852, steps = 2999, cost time = 6.31s
