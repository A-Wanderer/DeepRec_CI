INFO:tensorflow:vocabulary_size = 543060 in UID is inferred from the number of elements in the vocabulary_file ./data/uid_voc.txt.
INFO:tensorflow:vocabulary_size = 367983 in ITEM is inferred from the number of elements in the vocabulary_file ./data/mid_voc.txt.
INFO:tensorflow:vocabulary_size = 1601 in CATEGORY is inferred from the number of elements in the vocabulary_file ./data/cat_voc.txt.
INFO:tensorflow:vocabulary_size = 367983 in HISTORY_ITEM is inferred from the number of elements in the vocabulary_file ./data/mid_voc.txt.
INFO:tensorflow:vocabulary_size = 1601 in HISTORY_CATEGORY is inferred from the number of elements in the vocabulary_file ./data/cat_voc.txt.
INFO:tensorflow:vocabulary_size = 367983 in NOCLK_HISTORY_ITEM is inferred from the number of elements in the vocabulary_file ./data/mid_voc.txt.
INFO:tensorflow:vocabulary_size = 1601 in NOCLK_HISTORY_CATEGORY is inferred from the number of elements in the vocabulary_file ./data/cat_voc.txt.
INFO:tensorflow:Parsing ./data/local_train_splitByUser
INFO:tensorflow:Parsing ./data/local_test_splitByUser
2022-03-23 09:56:38.361760: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3299995000 Hz
2022-03-23 09:56:38.367600: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f200b6f39c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2022-03-23 09:56:38.367638: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2022-03-23 09:56:42.724629: I tensorflow/core/profiler/lib/profiler_session.cc:205] Profiler session started.
2022-03-23 09:58:17.176110: I tensorflow/core/profiler/lib/profiler_session.cc:205] Profiler session started.
2022-03-23 09:59:23.006216: I tensorflow/core/profiler/lib/profiler_session.cc:205] Profiler session started.
Using TensorFlow version 1.15.5
Checking dataset
Numbers of training dataset is 1086120
Numbers of test dataset is 121216
Saving model checkpoints to /benchmark_result/checkpoint/2022-03-23-17-47-08/dien_deeprec_fp32
Save timeline to /benchmark_result/checkpoint/2022-03-23-17-47-08/dien_deeprec_fp32
global_step/sec: 14.6854
loss = 0.9788111448287964, steps = 0, cost time = 6.81s
global_step/sec: 15.2636
loss = 0.9731624126434326, steps = 100, cost time = 6.55s
global_step/sec: 3.0301
loss = 0.980384111404419, steps = 200, cost time = 33.00s
global_step/sec: 15.6572
loss = 0.9601396322250366, steps = 300, cost time = 6.39s
global_step/sec: 15.6387
loss = 0.9193384647369385, steps = 400, cost time = 6.39s
global_step/sec: 15.6980
loss = 0.9534801244735718, steps = 500, cost time = 6.37s
global_step/sec: 15.7050
loss = 0.9397966265678406, steps = 600, cost time = 6.37s
global_step/sec: 15.6584
loss = 0.9042643904685974, steps = 700, cost time = 6.39s
global_step/sec: 15.6887
loss = 0.8994154930114746, steps = 800, cost time = 6.37s
global_step/sec: 15.6603
loss = 0.9379758834838867, steps = 900, cost time = 6.39s
Save timeline to /benchmark_result/checkpoint/2022-03-23-17-47-08/dien_deeprec_fp32
global_step/sec: 12.2249
loss = 0.9423385262489319, steps = 1000, cost time = 8.18s
global_step/sec: 15.6546
loss = 0.9399974346160889, steps = 1100, cost time = 6.39s
global_step/sec: 15.6823
loss = 0.9083091020584106, steps = 1200, cost time = 6.38s
global_step/sec: 15.5879
loss = 0.9231476783752441, steps = 1300, cost time = 6.42s
global_step/sec: 15.5651
loss = 0.9594168663024902, steps = 1400, cost time = 6.42s
global_step/sec: 15.6177
loss = 0.9447442293167114, steps = 1500, cost time = 6.40s
global_step/sec: 15.6282
loss = 0.8860304951667786, steps = 1600, cost time = 6.40s
global_step/sec: 15.6362
loss = 0.9619830250740051, steps = 1700, cost time = 6.40s
global_step/sec: 15.6108
loss = 0.8974349498748779, steps = 1800, cost time = 6.41s
global_step/sec: 15.6142
loss = 0.8870500922203064, steps = 1900, cost time = 6.40s
Save timeline to /benchmark_result/checkpoint/2022-03-23-17-47-08/dien_deeprec_fp32
global_step/sec: 12.3769
loss = 0.9742288589477539, steps = 2000, cost time = 8.08s
global_step/sec: 15.5946
loss = 0.964984655380249, steps = 2100, cost time = 6.41s
global_step/sec: 15.5859
loss = 0.8666654825210571, steps = 2200, cost time = 6.42s
global_step/sec: 15.5903
loss = 0.8832790851593018, steps = 2300, cost time = 6.41s
global_step/sec: 15.6065
loss = 0.8423242568969727, steps = 2400, cost time = 6.41s
global_step/sec: 15.5946
loss = 0.9541836977005005, steps = 2500, cost time = 6.41s
global_step/sec: 15.5037
loss = 0.8361778259277344, steps = 2600, cost time = 6.45s
global_step/sec: 15.5100
loss = 0.9623012542724609, steps = 2700, cost time = 6.45s
global_step/sec: 15.5384
loss = 0.8974210023880005, steps = 2800, cost time = 6.44s
global_step/sec: 15.5978
loss = 0.8373667001724243, steps = 2900, cost time = 6.41s
global_step/sec: 472.2509
loss = 0.901720404624939, steps = 2999, cost time = 6.35s
