INFO:tensorflow:vocabulary_size = 543060 in UID is inferred from the number of elements in the vocabulary_file ./data/uid_voc.txt.
INFO:tensorflow:vocabulary_size = 367983 in ITEM is inferred from the number of elements in the vocabulary_file ./data/mid_voc.txt.
INFO:tensorflow:vocabulary_size = 1601 in CATEGORY is inferred from the number of elements in the vocabulary_file ./data/cat_voc.txt.
INFO:tensorflow:vocabulary_size = 367983 in HISTORY_ITEM is inferred from the number of elements in the vocabulary_file ./data/mid_voc.txt.
INFO:tensorflow:vocabulary_size = 1601 in HISTORY_CATEGORY is inferred from the number of elements in the vocabulary_file ./data/cat_voc.txt.
INFO:tensorflow:vocabulary_size = 367983 in NOCLK_HISTORY_ITEM is inferred from the number of elements in the vocabulary_file ./data/mid_voc.txt.
INFO:tensorflow:vocabulary_size = 1601 in NOCLK_HISTORY_CATEGORY is inferred from the number of elements in the vocabulary_file ./data/cat_voc.txt.
INFO:tensorflow:Parsing ./data/local_train_splitByUser
INFO:tensorflow:Parsing ./data/local_test_splitByUser
2022-03-23 09:47:54.127776: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3299995000 Hz
2022-03-23 09:47:54.133631: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f57ac1e89c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2022-03-23 09:47:54.133679: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2022-03-23 09:47:58.302998: I tensorflow/core/profiler/lib/profiler_session.cc:205] Profiler session started.
2022-03-23 09:47:58.421481: I tensorflow/compiler/jit/xla_compilation_cache.cc:241] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-03-23 09:49:03.549224: I tensorflow/core/profiler/lib/profiler_session.cc:205] Profiler session started.
2022-03-23 09:50:06.853033: I tensorflow/core/profiler/lib/profiler_session.cc:205] Profiler session started.
Using TensorFlow version 1.15.5
Checking dataset
Numbers of training dataset is 1086120
Numbers of test dataset is 121216
Saving model checkpoints to /benchmark_result/checkpoint/2022-03-23-17-47-08/dien_deeprec_bf16
Save timeline to /benchmark_result/checkpoint/2022-03-23-17-47-08/dien_deeprec_bf16
global_step/sec: 15.1263
loss = 1.0611134767532349, steps = 0, cost time = 6.61s
global_step/sec: 16.2894
loss = 0.990378737449646, steps = 100, cost time = 6.14s
global_step/sec: 15.8428
loss = 1.004888892173767, steps = 200, cost time = 6.31s
global_step/sec: 16.4192
loss = 0.9879425168037415, steps = 300, cost time = 6.09s
global_step/sec: 16.3630
loss = 0.9352014660835266, steps = 400, cost time = 6.11s
global_step/sec: 16.3408
loss = 0.9926702976226807, steps = 500, cost time = 6.12s
global_step/sec: 16.3432
loss = 0.9681298732757568, steps = 600, cost time = 6.12s
global_step/sec: 16.2986
loss = 0.907551109790802, steps = 700, cost time = 6.14s
global_step/sec: 16.3141
loss = 0.923068642616272, steps = 800, cost time = 6.13s
global_step/sec: 16.3231
loss = 0.934585452079773, steps = 900, cost time = 6.13s
Save timeline to /benchmark_result/checkpoint/2022-03-23-17-47-08/dien_deeprec_bf16
global_step/sec: 12.7454
loss = 0.9458234906196594, steps = 1000, cost time = 7.85s
global_step/sec: 16.2896
loss = 0.9704844951629639, steps = 1100, cost time = 6.14s
global_step/sec: 16.2728
loss = 0.9354554414749146, steps = 1200, cost time = 6.15s
global_step/sec: 16.2496
loss = 0.9326155185699463, steps = 1300, cost time = 6.15s
global_step/sec: 16.2320
loss = 0.957024097442627, steps = 1400, cost time = 6.16s
global_step/sec: 16.1886
loss = 0.9666943550109863, steps = 1500, cost time = 6.18s
global_step/sec: 16.2404
loss = 0.9015222191810608, steps = 1600, cost time = 6.16s
global_step/sec: 16.2423
loss = 1.0003923177719116, steps = 1700, cost time = 6.16s
global_step/sec: 16.2082
loss = 0.917736291885376, steps = 1800, cost time = 6.17s
global_step/sec: 16.2298
loss = 0.9039936661720276, steps = 1900, cost time = 6.16s
Save timeline to /benchmark_result/checkpoint/2022-03-23-17-47-08/dien_deeprec_bf16
global_step/sec: 12.8709
loss = 0.9924538135528564, steps = 2000, cost time = 7.77s
global_step/sec: 16.1839
loss = 0.9980977177619934, steps = 2100, cost time = 6.18s
global_step/sec: 16.1989
loss = 0.890499472618103, steps = 2200, cost time = 6.17s
global_step/sec: 16.2020
loss = 0.9187424182891846, steps = 2300, cost time = 6.17s
global_step/sec: 16.2027
loss = 0.8732945919036865, steps = 2400, cost time = 6.17s
global_step/sec: 16.1790
loss = 0.9639996290206909, steps = 2500, cost time = 6.18s
global_step/sec: 16.1375
loss = 0.8597689270973206, steps = 2600, cost time = 6.20s
global_step/sec: 16.1632
loss = 0.9934401512145996, steps = 2700, cost time = 6.19s
global_step/sec: 16.1738
loss = 0.9124132394790649, steps = 2800, cost time = 6.18s
global_step/sec: 16.1406
loss = 0.8636806011199951, steps = 2900, cost time = 6.20s
global_step/sec: 489.0365
loss = 0.9301284551620483, steps = 2999, cost time = 6.13s
