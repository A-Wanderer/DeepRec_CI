INFO:tensorflow:Parsing ./data/train.csv
INFO:tensorflow:Parsing ./data/eval.csv
2022-03-23 09:51:15.660769: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3299995000 Hz
2022-03-23 09:51:15.666607: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fbdf0e29200 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2022-03-23 09:51:15.666650: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2022-03-23 09:51:18.530553: I tensorflow/core/profiler/lib/profiler_session.cc:205] Profiler session started.
2022-03-23 09:51:30.807241: I tensorflow/core/profiler/lib/profiler_session.cc:205] Profiler session started.
2022-03-23 09:51:40.631236: I tensorflow/core/profiler/lib/profiler_session.cc:205] Profiler session started.
Using TensorFlow version 1.15.5
Checking dataset
Numbers of training dataset is 8000000
Numbers of test dataset is 2000000
Saving model checkpoints to /benchmark_result/checkpoint/2022-03-23-17-47-08/dlrm_deeprec_bf16
Save timeline to /benchmark_result/checkpoint/2022-03-23-17-47-08/dlrm_deeprec_bf16
global_step/sec: 21.9813
loss = 0.6688438057899475, steps = 0, cost time = 4.55s
global_step/sec: 97.6730
loss = 0.4913358688354492, steps = 100, cost time = 1.02s
global_step/sec: 96.3610
loss = 0.46187523007392883, steps = 200, cost time = 1.04s
global_step/sec: 104.4307
loss = 0.5376430749893188, steps = 300, cost time = 0.96s
global_step/sec: 103.8919
loss = 0.5357784032821655, steps = 400, cost time = 0.96s
global_step/sec: 104.7734
loss = 0.5021770596504211, steps = 500, cost time = 0.95s
global_step/sec: 103.8332
loss = 0.5584231615066528, steps = 600, cost time = 0.96s
global_step/sec: 104.3793
loss = 0.5532057881355286, steps = 700, cost time = 0.96s
global_step/sec: 104.3143
loss = 0.541109561920166, steps = 800, cost time = 0.96s
global_step/sec: 104.0398
loss = 0.49975574016571045, steps = 900, cost time = 0.96s
Save timeline to /benchmark_result/checkpoint/2022-03-23-17-47-08/dlrm_deeprec_bf16
global_step/sec: 84.9363
loss = 0.5367001295089722, steps = 1000, cost time = 1.18s
global_step/sec: 103.8363
loss = 0.5438019037246704, steps = 1100, cost time = 0.96s
global_step/sec: 104.3202
loss = 0.5055984258651733, steps = 1200, cost time = 0.96s
global_step/sec: 104.6974
loss = 0.49151843786239624, steps = 1300, cost time = 0.96s
global_step/sec: 104.4011
loss = 0.49329283833503723, steps = 1400, cost time = 0.96s
global_step/sec: 104.2765
loss = 0.47769618034362793, steps = 1500, cost time = 0.96s
global_step/sec: 103.9034
loss = 0.48987409472465515, steps = 1600, cost time = 0.96s
global_step/sec: 103.8933
loss = 0.5161561965942383, steps = 1700, cost time = 0.96s
global_step/sec: 104.2532
loss = 0.4948514699935913, steps = 1800, cost time = 0.96s
global_step/sec: 104.2269
loss = 0.4997525215148926, steps = 1900, cost time = 0.96s
Save timeline to /benchmark_result/checkpoint/2022-03-23-17-47-08/dlrm_deeprec_bf16
global_step/sec: 87.6594
loss = 0.4796823263168335, steps = 2000, cost time = 1.14s
global_step/sec: 103.4905
loss = 0.4913804531097412, steps = 2100, cost time = 0.97s
global_step/sec: 104.4342
loss = 0.5354346632957458, steps = 2200, cost time = 0.96s
global_step/sec: 103.9004
loss = 0.4858221709728241, steps = 2300, cost time = 0.96s
global_step/sec: 103.8510
loss = 0.5174145102500916, steps = 2400, cost time = 0.96s
global_step/sec: 103.7343
loss = 0.4607263207435608, steps = 2500, cost time = 0.96s
global_step/sec: 103.5034
loss = 0.5017789006233215, steps = 2600, cost time = 0.97s
global_step/sec: 104.0795
loss = 0.546201229095459, steps = 2700, cost time = 0.96s
global_step/sec: 104.3399
loss = 0.5038527250289917, steps = 2800, cost time = 0.96s
global_step/sec: 103.9265
loss = 0.5209802389144897, steps = 2900, cost time = 0.96s
global_step/sec: 3147.5362
loss = 0.5261390805244446, steps = 2999, cost time = 0.95s
