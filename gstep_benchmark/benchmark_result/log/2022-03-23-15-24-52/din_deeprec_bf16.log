INFO:tensorflow:vocabulary_size = 543060 in UID is inferred from the number of elements in the vocabulary_file ./data/uid_voc.txt.
INFO:tensorflow:vocabulary_size = 367983 in ITEM is inferred from the number of elements in the vocabulary_file ./data/mid_voc.txt.
INFO:tensorflow:vocabulary_size = 1601 in CATEGORY is inferred from the number of elements in the vocabulary_file ./data/cat_voc.txt.
INFO:tensorflow:vocabulary_size = 367983 in HISTORY_ITEM is inferred from the number of elements in the vocabulary_file ./data/mid_voc.txt.
INFO:tensorflow:vocabulary_size = 1601 in HISTORY_CATEGORY is inferred from the number of elements in the vocabulary_file ./data/cat_voc.txt.
INFO:tensorflow:Parsing ./data/local_train_splitByUser
INFO:tensorflow:Parsing ./data/local_test_splitByUser
2022-03-23 07:24:58.447766: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3299995000 Hz
2022-03-23 07:24:58.453065: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fae16b7fc00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2022-03-23 07:24:58.453102: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2022-03-23 07:25:00.933087: I tensorflow/core/profiler/lib/profiler_session.cc:205] Profiler session started.
2022-03-23 07:25:01.006667: I tensorflow/compiler/jit/xla_compilation_cache.cc:241] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2022-03-23 07:25:11.647738: I tensorflow/core/profiler/lib/profiler_session.cc:205] Profiler session started.
2022-03-23 07:25:21.270322: I tensorflow/core/profiler/lib/profiler_session.cc:205] Profiler session started.
Using TensorFlow version 1.15.5
Checking dataset
Numbers of training dataset is 1086120
Numbers of test dataset is 121216
Saving model checkpoints to /benchmark_result/checkpoint/2022-03-23-15-24-52/din_deeprec_bf16
Save timeline to /benchmark_result/checkpoint/2022-03-23-15-24-52/din_deeprec_bf16
global_step/sec: 40.1704
loss = 0.6962002515792847, steps = 0, cost time = 2.49s
global_step/sec: 99.0612
loss = 0.6986684799194336, steps = 100, cost time = 1.01s
global_step/sec: 91.8320
loss = 0.6868606805801392, steps = 200, cost time = 1.09s
global_step/sec: 105.5751
loss = 0.6720449924468994, steps = 300, cost time = 0.95s
global_step/sec: 105.3832
loss = 0.6645580530166626, steps = 400, cost time = 0.95s
global_step/sec: 106.2265
loss = 0.6706624031066895, steps = 500, cost time = 0.94s
global_step/sec: 105.4809
loss = 0.6627956628799438, steps = 600, cost time = 0.95s
global_step/sec: 106.0876
loss = 0.6464424133300781, steps = 700, cost time = 0.94s
global_step/sec: 106.2141
loss = 0.6247005462646484, steps = 800, cost time = 0.94s
global_step/sec: 105.2698
loss = 0.644119918346405, steps = 900, cost time = 0.95s
Save timeline to /benchmark_result/checkpoint/2022-03-23-15-24-52/din_deeprec_bf16
global_step/sec: 93.6182
loss = 0.665047824382782, steps = 1000, cost time = 1.07s
global_step/sec: 106.0844
loss = 0.6742651462554932, steps = 1100, cost time = 0.94s
global_step/sec: 105.0173
loss = 0.6411594152450562, steps = 1200, cost time = 0.95s
global_step/sec: 105.5612
loss = 0.5995266437530518, steps = 1300, cost time = 0.95s
global_step/sec: 105.5184
loss = 0.6541420221328735, steps = 1400, cost time = 0.95s
global_step/sec: 104.7956
loss = 0.6611947417259216, steps = 1500, cost time = 0.95s
global_step/sec: 105.0013
loss = 0.6519496440887451, steps = 1600, cost time = 0.95s
global_step/sec: 105.1449
loss = 0.6359232664108276, steps = 1700, cost time = 0.95s
global_step/sec: 105.0780
loss = 0.6429142951965332, steps = 1800, cost time = 0.95s
global_step/sec: 104.9486
loss = 0.6503036618232727, steps = 1900, cost time = 0.95s
Save timeline to /benchmark_result/checkpoint/2022-03-23-15-24-52/din_deeprec_bf16
global_step/sec: 94.7795
loss = 0.6942249536514282, steps = 2000, cost time = 1.06s
global_step/sec: 104.8408
loss = 0.6441272497177124, steps = 2100, cost time = 0.95s
global_step/sec: 105.1633
loss = 0.5824155807495117, steps = 2200, cost time = 0.95s
global_step/sec: 105.3706
loss = 0.6351410746574402, steps = 2300, cost time = 0.95s
global_step/sec: 104.9996
loss = 0.6191678047180176, steps = 2400, cost time = 0.95s
global_step/sec: 104.6354
loss = 0.6575407981872559, steps = 2500, cost time = 0.96s
global_step/sec: 104.9248
loss = 0.5634408593177795, steps = 2600, cost time = 0.95s
global_step/sec: 104.9832
loss = 0.6711305379867554, steps = 2700, cost time = 0.95s
global_step/sec: 105.2831
loss = 0.5944298505783081, steps = 2800, cost time = 0.95s
global_step/sec: 104.9324
loss = 0.584731936454773, steps = 2900, cost time = 0.95s
global_step/sec: 3181.9209
loss = 0.6080014109611511, steps = 2999, cost time = 0.94s
