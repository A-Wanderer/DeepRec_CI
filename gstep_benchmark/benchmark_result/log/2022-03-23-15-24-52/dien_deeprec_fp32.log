INFO:tensorflow:vocabulary_size = 543060 in UID is inferred from the number of elements in the vocabulary_file ./data/uid_voc.txt.
INFO:tensorflow:vocabulary_size = 367983 in ITEM is inferred from the number of elements in the vocabulary_file ./data/mid_voc.txt.
INFO:tensorflow:vocabulary_size = 1601 in CATEGORY is inferred from the number of elements in the vocabulary_file ./data/cat_voc.txt.
INFO:tensorflow:vocabulary_size = 367983 in HISTORY_ITEM is inferred from the number of elements in the vocabulary_file ./data/mid_voc.txt.
INFO:tensorflow:vocabulary_size = 1601 in HISTORY_CATEGORY is inferred from the number of elements in the vocabulary_file ./data/cat_voc.txt.
INFO:tensorflow:vocabulary_size = 367983 in NOCLK_HISTORY_ITEM is inferred from the number of elements in the vocabulary_file ./data/mid_voc.txt.
INFO:tensorflow:vocabulary_size = 1601 in NOCLK_HISTORY_CATEGORY is inferred from the number of elements in the vocabulary_file ./data/cat_voc.txt.
INFO:tensorflow:Parsing ./data/local_train_splitByUser
INFO:tensorflow:Parsing ./data/local_test_splitByUser
2022-03-23 07:34:17.144759: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3299995000 Hz
2022-03-23 07:34:17.151385: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f04e0c739c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2022-03-23 07:34:17.151435: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2022-03-23 07:34:21.279425: I tensorflow/core/profiler/lib/profiler_session.cc:205] Profiler session started.
2022-03-23 07:35:56.562798: I tensorflow/core/profiler/lib/profiler_session.cc:205] Profiler session started.
2022-03-23 07:37:01.882698: I tensorflow/core/profiler/lib/profiler_session.cc:205] Profiler session started.
Using TensorFlow version 1.15.5
Checking dataset
Numbers of training dataset is 1086120
Numbers of test dataset is 121216
Saving model checkpoints to /benchmark_result/checkpoint/2022-03-23-15-24-52/dien_deeprec_fp32
Save timeline to /benchmark_result/checkpoint/2022-03-23-15-24-52/dien_deeprec_fp32
global_step/sec: 14.9701
loss = 0.9788111448287964, steps = 0, cost time = 6.68s
global_step/sec: 15.4825
loss = 0.9731624126434326, steps = 100, cost time = 6.46s
global_step/sec: 2.9271
loss = 0.9789115786552429, steps = 200, cost time = 34.16s
global_step/sec: 15.7359
loss = 0.959695041179657, steps = 300, cost time = 6.35s
global_step/sec: 15.7512
loss = 0.9178256988525391, steps = 400, cost time = 6.35s
global_step/sec: 15.7515
loss = 0.9535038471221924, steps = 500, cost time = 6.35s
global_step/sec: 15.7948
loss = 0.9358230829238892, steps = 600, cost time = 6.33s
global_step/sec: 15.7667
loss = 0.9043150544166565, steps = 700, cost time = 6.34s
global_step/sec: 15.7475
loss = 0.8987551331520081, steps = 800, cost time = 6.35s
global_step/sec: 15.7436
loss = 0.9397757053375244, steps = 900, cost time = 6.35s
Save timeline to /benchmark_result/checkpoint/2022-03-23-15-24-52/dien_deeprec_fp32
global_step/sec: 12.3314
loss = 0.9386130571365356, steps = 1000, cost time = 8.11s
global_step/sec: 15.7481
loss = 0.9453141689300537, steps = 1100, cost time = 6.35s
global_step/sec: 15.7471
loss = 0.9093884825706482, steps = 1200, cost time = 6.35s
global_step/sec: 15.7155
loss = 0.9244220852851868, steps = 1300, cost time = 6.36s
global_step/sec: 15.7127
loss = 0.9619429111480713, steps = 1400, cost time = 6.36s
global_step/sec: 15.7157
loss = 0.9475616216659546, steps = 1500, cost time = 6.36s
global_step/sec: 15.7680
loss = 0.887070894241333, steps = 1600, cost time = 6.34s
global_step/sec: 15.7530
loss = 0.970024824142456, steps = 1700, cost time = 6.35s
global_step/sec: 15.7285
loss = 0.8993220329284668, steps = 1800, cost time = 6.36s
global_step/sec: 15.7474
loss = 0.8878063559532166, steps = 1900, cost time = 6.35s
Save timeline to /benchmark_result/checkpoint/2022-03-23-15-24-52/dien_deeprec_fp32
global_step/sec: 12.5083
loss = 0.9724371433258057, steps = 2000, cost time = 7.99s
global_step/sec: 15.7121
loss = 0.9701165556907654, steps = 2100, cost time = 6.36s
global_step/sec: 15.7436
loss = 0.8668439388275146, steps = 2200, cost time = 6.35s
global_step/sec: 15.7104
loss = 0.8765664100646973, steps = 2300, cost time = 6.37s
global_step/sec: 15.7604
loss = 0.8437491655349731, steps = 2400, cost time = 6.35s
global_step/sec: 15.7186
loss = 0.9628266096115112, steps = 2500, cost time = 6.36s
global_step/sec: 15.7082
loss = 0.8364795446395874, steps = 2600, cost time = 6.37s
global_step/sec: 15.6860
loss = 0.9666354656219482, steps = 2700, cost time = 6.38s
global_step/sec: 15.7189
loss = 0.8904290795326233, steps = 2800, cost time = 6.36s
global_step/sec: 15.6972
loss = 0.8460787534713745, steps = 2900, cost time = 6.37s
global_step/sec: 475.0087
loss = 0.9005701541900635, steps = 2999, cost time = 6.31s
