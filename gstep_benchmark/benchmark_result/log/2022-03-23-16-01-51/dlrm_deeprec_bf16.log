INFO:tensorflow:Parsing ./data/train.csv
INFO:tensorflow:Parsing ./data/eval.csv
2022-03-23 08:05:56.833772: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3299995000 Hz
2022-03-23 08:05:56.839516: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f15a9369200 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2022-03-23 08:05:56.839559: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2022-03-23 08:05:59.703419: I tensorflow/core/profiler/lib/profiler_session.cc:205] Profiler session started.
2022-03-23 08:06:11.869220: I tensorflow/core/profiler/lib/profiler_session.cc:205] Profiler session started.
2022-03-23 08:06:21.547758: I tensorflow/core/profiler/lib/profiler_session.cc:205] Profiler session started.
Using TensorFlow version 1.15.5
Checking dataset
Numbers of training dataset is 8000000
Numbers of test dataset is 2000000
Saving model checkpoints to /benchmark_result/checkpoint/2022-03-23-16-01-51/dlrm_deeprec_bf16
Save timeline to /benchmark_result/checkpoint/2022-03-23-16-01-51/dlrm_deeprec_bf16
global_step/sec: 21.8936
loss = 0.6688438057899475, steps = 0, cost time = 4.57s
global_step/sec: 98.6397
loss = 0.4913358688354492, steps = 100, cost time = 1.01s
global_step/sec: 96.8397
loss = 0.46187523007392883, steps = 200, cost time = 1.03s
global_step/sec: 105.2555
loss = 0.5376430749893188, steps = 300, cost time = 0.95s
global_step/sec: 105.7765
loss = 0.5357784032821655, steps = 400, cost time = 0.95s
global_step/sec: 105.1966
loss = 0.5021770596504211, steps = 500, cost time = 0.95s
global_step/sec: 105.2820
loss = 0.5584231615066528, steps = 600, cost time = 0.95s
global_step/sec: 105.6859
loss = 0.5532057881355286, steps = 700, cost time = 0.95s
global_step/sec: 105.6206
loss = 0.541109561920166, steps = 800, cost time = 0.95s
global_step/sec: 105.7355
loss = 0.49975574016571045, steps = 900, cost time = 0.95s
Save timeline to /benchmark_result/checkpoint/2022-03-23-16-01-51/dlrm_deeprec_bf16
global_step/sec: 86.1729
loss = 0.5367001295089722, steps = 1000, cost time = 1.16s
global_step/sec: 105.0194
loss = 0.5438019037246704, steps = 1100, cost time = 0.95s
global_step/sec: 106.1456
loss = 0.5055984258651733, steps = 1200, cost time = 0.94s
global_step/sec: 105.4138
loss = 0.49151843786239624, steps = 1300, cost time = 0.95s
global_step/sec: 105.3173
loss = 0.49329283833503723, steps = 1400, cost time = 0.95s
global_step/sec: 105.8747
loss = 0.47769618034362793, steps = 1500, cost time = 0.94s
global_step/sec: 106.2365
loss = 0.48987409472465515, steps = 1600, cost time = 0.94s
global_step/sec: 105.5548
loss = 0.5161561965942383, steps = 1700, cost time = 0.95s
global_step/sec: 105.8049
loss = 0.4948514699935913, steps = 1800, cost time = 0.95s
global_step/sec: 106.0968
loss = 0.4997525215148926, steps = 1900, cost time = 0.94s
Save timeline to /benchmark_result/checkpoint/2022-03-23-16-01-51/dlrm_deeprec_bf16
global_step/sec: 89.1168
loss = 0.4796823263168335, steps = 2000, cost time = 1.12s
global_step/sec: 105.8751
loss = 0.4913804531097412, steps = 2100, cost time = 0.94s
global_step/sec: 106.0095
loss = 0.5354346632957458, steps = 2200, cost time = 0.94s
global_step/sec: 105.4286
loss = 0.4858221709728241, steps = 2300, cost time = 0.95s
global_step/sec: 105.6785
loss = 0.5174145102500916, steps = 2400, cost time = 0.95s
global_step/sec: 105.7859
loss = 0.4607263207435608, steps = 2500, cost time = 0.95s
global_step/sec: 105.2260
loss = 0.5017789006233215, steps = 2600, cost time = 0.95s
global_step/sec: 105.4105
loss = 0.546201229095459, steps = 2700, cost time = 0.95s
global_step/sec: 105.1806
loss = 0.5038527250289917, steps = 2800, cost time = 0.95s
global_step/sec: 105.5988
loss = 0.5209802389144897, steps = 2900, cost time = 0.95s
global_step/sec: 3177.6067
loss = 0.5261390805244446, steps = 2999, cost time = 0.94s
