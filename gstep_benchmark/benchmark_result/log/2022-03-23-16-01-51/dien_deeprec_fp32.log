INFO:tensorflow:vocabulary_size = 543060 in UID is inferred from the number of elements in the vocabulary_file ./data/uid_voc.txt.
INFO:tensorflow:vocabulary_size = 367983 in ITEM is inferred from the number of elements in the vocabulary_file ./data/mid_voc.txt.
INFO:tensorflow:vocabulary_size = 1601 in CATEGORY is inferred from the number of elements in the vocabulary_file ./data/cat_voc.txt.
INFO:tensorflow:vocabulary_size = 367983 in HISTORY_ITEM is inferred from the number of elements in the vocabulary_file ./data/mid_voc.txt.
INFO:tensorflow:vocabulary_size = 1601 in HISTORY_CATEGORY is inferred from the number of elements in the vocabulary_file ./data/cat_voc.txt.
INFO:tensorflow:vocabulary_size = 367983 in NOCLK_HISTORY_ITEM is inferred from the number of elements in the vocabulary_file ./data/mid_voc.txt.
INFO:tensorflow:vocabulary_size = 1601 in NOCLK_HISTORY_CATEGORY is inferred from the number of elements in the vocabulary_file ./data/cat_voc.txt.
INFO:tensorflow:Parsing ./data/local_train_splitByUser
INFO:tensorflow:Parsing ./data/local_test_splitByUser
2022-03-23 08:11:17.387755: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3299995000 Hz
2022-03-23 08:11:17.392386: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f00cb8b39c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2022-03-23 08:11:17.392420: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2022-03-23 08:11:21.674140: I tensorflow/core/profiler/lib/profiler_session.cc:205] Profiler session started.
2022-03-23 08:12:56.695694: I tensorflow/core/profiler/lib/profiler_session.cc:205] Profiler session started.
2022-03-23 08:14:01.830454: I tensorflow/core/profiler/lib/profiler_session.cc:205] Profiler session started.
Using TensorFlow version 1.15.5
Checking dataset
Numbers of training dataset is 1086120
Numbers of test dataset is 121216
Saving model checkpoints to /benchmark_result/checkpoint/2022-03-23-16-01-51/dien_deeprec_fp32
Save timeline to /benchmark_result/checkpoint/2022-03-23-16-01-51/dien_deeprec_fp32
global_step/sec: 14.8188
loss = 0.9788111448287964, steps = 0, cost time = 6.75s
global_step/sec: 15.4659
loss = 0.9731624126434326, steps = 100, cost time = 6.47s
global_step/sec: 2.9294
loss = 0.980384111404419, steps = 200, cost time = 34.14s
global_step/sec: 15.8133
loss = 0.9601396322250366, steps = 300, cost time = 6.32s
global_step/sec: 15.8183
loss = 0.9193384647369385, steps = 400, cost time = 6.32s
global_step/sec: 15.8299
loss = 0.953646183013916, steps = 500, cost time = 6.32s
global_step/sec: 15.8436
loss = 0.9405441284179688, steps = 600, cost time = 6.31s
global_step/sec: 15.8309
loss = 0.9037496447563171, steps = 700, cost time = 6.32s
global_step/sec: 15.8201
loss = 0.8981205224990845, steps = 800, cost time = 6.32s
global_step/sec: 15.8221
loss = 0.9363875985145569, steps = 900, cost time = 6.32s
Save timeline to /benchmark_result/checkpoint/2022-03-23-16-01-51/dien_deeprec_fp32
global_step/sec: 12.3330
loss = 0.9415783286094666, steps = 1000, cost time = 8.11s
global_step/sec: 15.8041
loss = 0.9398113489151001, steps = 1100, cost time = 6.33s
global_step/sec: 15.8255
loss = 0.9086623191833496, steps = 1200, cost time = 6.32s
global_step/sec: 15.7372
loss = 0.924248218536377, steps = 1300, cost time = 6.35s
global_step/sec: 15.7562
loss = 0.9618808627128601, steps = 1400, cost time = 6.35s
global_step/sec: 15.7867
loss = 0.9492831230163574, steps = 1500, cost time = 6.33s
global_step/sec: 15.8157
loss = 0.8865830302238464, steps = 1600, cost time = 6.32s
global_step/sec: 15.7842
loss = 0.9609286785125732, steps = 1700, cost time = 6.34s
global_step/sec: 15.7729
loss = 0.8978128433227539, steps = 1800, cost time = 6.34s
global_step/sec: 15.7996
loss = 0.88310706615448, steps = 1900, cost time = 6.33s
Save timeline to /benchmark_result/checkpoint/2022-03-23-16-01-51/dien_deeprec_fp32
global_step/sec: 12.4802
loss = 0.9835468530654907, steps = 2000, cost time = 8.01s
global_step/sec: 15.7828
loss = 0.9625540971755981, steps = 2100, cost time = 6.34s
global_step/sec: 15.7775
loss = 0.8639029264450073, steps = 2200, cost time = 6.34s
global_step/sec: 15.7567
loss = 0.8840253353118896, steps = 2300, cost time = 6.35s
global_step/sec: 15.8201
loss = 0.835338830947876, steps = 2400, cost time = 6.32s
global_step/sec: 15.7940
loss = 0.9574539661407471, steps = 2500, cost time = 6.33s
global_step/sec: 15.7643
loss = 0.8364071846008301, steps = 2600, cost time = 6.34s
global_step/sec: 15.7659
loss = 0.9619331955909729, steps = 2700, cost time = 6.34s
global_step/sec: 15.7442
loss = 0.8977410793304443, steps = 2800, cost time = 6.35s
global_step/sec: 15.7526
loss = 0.835121750831604, steps = 2900, cost time = 6.35s
global_step/sec: 477.1291
loss = 0.905964195728302, steps = 2999, cost time = 6.29s
