WARNING:tensorflow:From train.py:17: The name tf.logging.set_verbosity is deprecated. Please use tf.compat.v1.logging.set_verbosity instead.

WARNING:tensorflow:From train.py:17: The name tf.logging.INFO is deprecated. Please use tf.compat.v1.logging.INFO instead.

WARNING:tensorflow:From train.py:510: The name tf.set_random_seed is deprecated. Please use tf.compat.v1.set_random_seed instead.

WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/tensorflow_core/python/data/util/random_seed.py:58: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/tensorflow_core/python/autograph/converters/directives.py:119: The name tf.logging.info is deprecated. Please use tf.compat.v1.logging.info instead.

INFO:tensorflow:Parsing ./data/taobao_train_data
INFO:tensorflow:Parsing ./data/taobao_test_data
WARNING:tensorflow:From train.py:650: The name tf.data.Iterator is deprecated. Please use tf.compat.v1.data.Iterator instead.

WARNING:tensorflow:From train.py:650: DatasetV1.output_types (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.compat.v1.data.get_output_types(dataset)`.
WARNING:tensorflow:From train.py:651: DatasetV1.output_shapes (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.compat.v1.data.get_output_shapes(dataset)`.
WARNING:tensorflow:From train.py:152: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From train.py:152: The name tf.AUTO_REUSE is deprecated. Please use tf.compat.v1.AUTO_REUSE instead.

Using TensorFlow version 1.15.5
Checking dataset
Numbers of training dataset: 50000
Number of epochs: 10
Number of train steps: 977
Numbers of test dataset: 10000
Numbers of test steps: 20
Running stand-alone mode training.
Traceback (most recent call last):
  File "train.py", line 660, in <module>
    bf16=args.bf16)    
  File "train.py", line 204, in __init__
    self.model = self.__build_model()
  File "train.py", line 232, in __build_model
    with make_scope('input_layer', self.__bf16, self.__input_layer_partitioner):
  File "train.py", line 152, in make_scope
    return tf.variable_scope(name, partitioner=part, reuse=tf.AUTO_REUSE).keep_weights()
AttributeError: 'variable_scope' object has no attribute 'keep_weights'
